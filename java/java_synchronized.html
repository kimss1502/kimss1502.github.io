<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>synchronized | 내 맘대로 블로그</title>
<meta name="description" content="자바 Thread에 대한 내용은 자바의 Thread 포스팅을 참고할 것.">


  <meta name="author" content="KIMSS">


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="내 맘대로 블로그">
<meta property="og:title" content="synchronized">
<meta property="og:url" content="http://localhost:4000/java/java_synchronized">


  <meta property="og:description" content="자바 Thread에 대한 내용은 자바의 Thread 포스팅을 참고할 것.">







  <meta property="article:published_time" content="2016-01-01T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/java/java_synchronized">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "안드로이드 개발 및 기타",
      "url": "http://localhost:4000/"
    
  }
</script>


  <meta name="google-site-verification" content="25fsY7AInJqIAdb8Vv-48IGkeV3PSkILUE6h6ovfdjQ" />





  <meta name="naver-site-verification" content="1ee74ce5d72ee1a7b21ffc798e9119fb03749830">

<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="내 맘대로 블로그 Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          내 맘대로 블로그
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Category</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tag</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Years</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">KIMSS</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>개인 개발 공부 Archive 입니다. 오래전 정리한 내용에는 일부 잘못된 내용이 포함되어 있을 수 있고 출처표기가 부족할 수 있습니다. (아직 초기 세팅 중입니다.)</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Republic of Korea</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
        
          
        
      

      

      
        <li>
          <a href="mailto:kssappmail@naver.com">
            <meta itemprop="email" content="kssappmail@naver.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">이메일</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">토글 메뉴</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Category</span>
        

        
        <ul>
          
            <li><a href="/categories/android">안드로이드</a></li>
          
            <li><a href="/categories/java">자바</a></li>
          
            <li><a href="/categories/designpattern">디자인패턴</a></li>
          
            <li><a href="/categories/security">보안</a></li>
          
            <li><a href="/categories/basic">개발 etc</a></li>
          
            <li><a href="/categories/blogging">블로깅</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="synchronized">
    <meta itemprop="description" content="  자바 Thread에 대한 내용은 자바의 Thread 포스팅을 참고할 것. ">
    <meta itemprop="datePublished" content="2016-01-01T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">synchronized
</h1>
          


  <p class="page__meta">

    
      
      <i class="far fa-calendar-alt" aria-hidden="true"></i>
      <time datetime="2016-01-01T00:00:00+09:00">January 1, 2016</time>
    

    
      
      <span class="post__meta-sep"></span>
      
    

    
      
      

      <i class="far fa-clock" aria-hidden="true"></i>
      
        4 분 소요
      
    

  </p>

        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu">
  <li><a href="#1-instance-method-동기화">1. instance method 동기화</a></li>
  <li><a href="#2-static-method-동기화">2. static method 동기화</a></li>
  <li><a href="#3-동기화-블럭을-활용한-객체-동기화">3. 동기화 블럭을 활용한 객체 동기화</a>
    <ul>
      <li><a href="#31-모니터-객체-활용">3.1. 모니터 객체 활용</a></li>
      <li><a href="#32-클래스-객체-동기화">3.2. 클래스 객체 동기화</a></li>
    </ul>
  </li>
  <li><a href="#4-자바-concurrency-유틸리티">4. 자바 Concurrency 유틸리티</a></li>
</ul>

            </nav>
          </aside>
        
        <blockquote>
  <p>자바 Thread에 대한 내용은 <a href="../java/thread">자바의 Thread</a> 포스팅을 참고할 것. <br /></p>
</blockquote>

<p>자바에서는 <strong>synchronized</strong> 키워드를 이용해 Multi Thread 환경에서 동기화를 제공한다. <br /></p>

<p>synchronized 키워드는 메서드 앞에 쓰여 메서드에 대한 동기화가 되거나 synchronized 블럭을 만들면서 객체를 전달하여 객체에 대한 동기화를 할 수 있다.</p>

<h2 id="1-instance-method-동기화">1. instance method 동기화</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">){</span>
    <span class="k">this</span><span class="o">.</span><span class="na">count</span> <span class="o">+=</span> <span class="n">value</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>위와 같은 <strong>instance 메서드 동기화는 자기 instance(this)를 기준으로 동기화 한다.</strong> <br />
 클래스가 기준이 아니라 <strong>객체</strong>가 기준이라는 것에 주의하자. <strong>해당 객체에서 synchronized 가 걸린 모든 메서드는 동기화 된다.</strong> <br />
 즉, 하나의 인스턴스에 대해 여러 Thread에서 동시에 접근할 수 있는 메서드는 단 하나이다.</p>

<blockquote>
  <p>햇갈리지 말자. 동기화는 객체를 기준으로 되는것이고, synchronized가 걸린 해당 메서드만 동기화 되는게 아니라 해당 클래스에 있는 모든 synchronized 메서드는 동기화된다.</p>
</blockquote>

<p>예를 들어 아래와 같은 코드가 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BlackOrWhite</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">str</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">BLACK</span> <span class="o">=</span> <span class="s">"black"</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">WHITE</span> <span class="o">=</span> <span class="s">"white"</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">black</span><span class="o">(){</span>
        <span class="n">str</span> <span class="o">=</span> <span class="no">BLACK</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kt">long</span> <span class="n">sleep</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()*</span><span class="mi">100L</span><span class="o">);</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">sleep</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">str</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="no">BLACK</span><span class="o">))</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"++++++broken!!++++++"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">white</span><span class="o">(){</span>
        <span class="n">str</span> <span class="o">=</span> <span class="no">WHITE</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kt">long</span> <span class="n">sleep</span> <span class="o">=</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()*</span><span class="mi">100L</span><span class="o">);</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">sleep</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">str</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="no">WHITE</span><span class="o">))</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"++++++broken!!++++++"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="nc">BlackOrWhite</span> <span class="n">bow</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BlackOrWhite</span><span class="o">();</span>
        <span class="nc">Thread</span> <span class="n">white</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">bow</span><span class="o">.</span><span class="na">white</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">};</span>
        <span class="nc">Thread</span> <span class="n">black</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">bow</span><span class="o">.</span><span class="na">black</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">};</span>
        <span class="n">white</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="n">black</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>위 코드에서 whtie Thread와 black Thread는 bow 라는 인스턴스를 공유하면서 각자 white()와 black() 메서드를 호출한다.<br />
 위 내용을 실행해보면 동기화가 잘 이루어져 broken 이라는 문자는 절때 찍히지 안는다. <br /></p>

<p>서로 다른 Thread에서 각각 black()과 white()를 호출하고 있지만 두 메서드 모두 bow 인스턴스의 메서드 콜이기 때문에 동일한 객체에 대한 동기화가 이루어 진 것이다.</p>

<h2 id="2-static-method-동기화">2. static method 동기화</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">){</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="n">value</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>위와 같이 <strong>static 메서드 동기화는 이 메서드를 가진 클래스 객체를 기준</strong>으로 이루어진다. <br />
 JVM 안에 클래스 객체는 클래스 당 하나만 존재할 수 있다.</p>

<p>즉, 인스턴스에 따라서 동기화되는 instance 메서드 동기화와 달리 static 메서드 동기화는 클래스에 대해서 동기화 되어 어떤 인스턴스가 어떤 Thread에서 실행되던지와 무관하게 동시에 접근이 불가능하다.</p>

<h2 id="3-동기화-블럭을-활용한-객체-동기화">3. 동기화 블럭을 활용한 객체 동기화</h2>
<p>동기화가 반드시 메서드 전체에 대해 이루어져야 하는 것은 아니다. 동기화를 잘못 할 경우 전체 성능을 크게 떨어트리기 때문에 종종 메서드 특정 부분에 대해서만 동기화를 제공하는 것이 효율적일 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">){</span>
    <span class="kd">synchronized</span><span class="o">(</span><span class="k">this</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">count</span> <span class="o">+=</span> <span class="n">value</span><span class="o">;</span>   
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>위와 같이 메서드 안에서 synchronized 블럭을 따로 쓸 수 있다. <br />
참고로 위와 같이 <strong>메서드 내부 전체가 synchronized 블럭으로 잡힌 경우 메서드 자체에 synchronized를 건 것과 동일한 동작을 하게 된다.</strong></p>

<p>동기화 블럭은 객체를 전달받고 있다.(여기에서는 자기 자신 객체인 this가 전달되었다. 자기 자신이라 함은 현재 add를 호출한 객체를 의미한다.)</p>

<p>이와 같이 동기화 블럭안에 전달되는 객체를 <strong>모니터 객체</strong> 라고 한다. 동기화 블럭은 모니터 객체를 기준으로 동기화가 이루어진다.</p>

<blockquote>
  <p>현재 메서드 자체에 synchronized를 건것과 동일한 이유는 synchronized를 건 범위가 메서드 구현부 전체이면서 모니터 객체가 this이기 때문이다.</p>
</blockquote>

<p>만약 method가 static 이라면 모니터 객체로 자기 자신 클래스(XXX.class)로 하면 역시 동일한 의미를 가진다.</p>

<h3 id="31-모니터-객체-활용">3.1. 모니터 객체 활용</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TwoMap</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">map1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;();</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">map2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;();</span>
    
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">put1</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">value</span><span class="o">){</span>
        <span class="n">map1</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">put2</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">value</span><span class="o">){</span>
        <span class="n">map2</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="nc">String</span> <span class="nf">get1</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">){</span>
        <span class="k">return</span> <span class="n">map1</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="nc">String</span> <span class="nf">get2</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">){</span>
        <span class="k">return</span> <span class="n">map2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>위 코드는 비효율적으로 동작한다. 실제로 동기화가 이뤄져야 하는 코드는 put1()과 get1() 그리고 put2()와 get2()이다. 하지만 모든 인스턴스 메서드에 synchronized가 걸려있어 하나의 인스턴스는 동시에 하나의 메서드만 사용이 가능하게 되버린다. <br />
 실제로는 pu1이 실행됨과 동시에 pu2가 실행되어도 무관한데 말이다.</p>

<p>이 때 모니터 객체를 활용할 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TwoMap</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">map1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;();</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">map2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;();</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Object</span> <span class="n">syncObj1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">();</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Object</span> <span class="n">syncObj2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">();</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">put1</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">value</span><span class="o">){</span>
        <span class="kd">synchronized</span> <span class="o">(</span><span class="n">syncObj1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">map1</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">put2</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">value</span><span class="o">){</span>        
        <span class="kd">synchronized</span> <span class="o">(</span><span class="n">syncObj2</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">map2</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
  
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">get1</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">){</span>
        <span class="kd">synchronized</span> <span class="o">(</span><span class="n">syncObj1</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">map1</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">get2</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">){</span>
        <span class="kd">synchronized</span> <span class="o">(</span><span class="n">syncObj2</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">map2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>위는 동기화 되어야 하는 쌍인 put1(), get1()이 syncObj1 객체에 의해 동기화 되고 put2(), get2()가 syncObj2 객체에 의해 동기화되어 이전보다 효율적으로 동작한다.</p>

<h3 id="32-클래스-객체-동기화">3.2. 클래스 객체 동기화</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kt">void</span> <span class="nf">printLog</span><span class="o">(</span><span class="nc">String</span> <span class="n">log</span><span class="o">)</span> <span class="o">{</span>

    <span class="kd">synchronized</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Object</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"디버깅 시작했다~"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">log</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"디버깅 끝났다~"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>위는 모니터 객첼 모든 class의 부모인 Object 클래스 객체에 대해서 동기화를 했다. <br />
이 코드는 어떤 클래스가 어떤 Thread에서 실행되든지 절때 중복해서 실행되지 않는다.</p>

<p>이렇게 클래스를 기준으로 동기화 할 경우 static 메서드 동기화와 같이 같은 클래스에 대해서 동기화 되어 어떤 인스턴스가 어떤 Thread에서 실행되던지와 무관하게 동시에 접근이 불가능하다.</p>

<p>참고로 아래 둘은 같은 동작을 한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyClass</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">){</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyClass</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">){</span>
        <span class="kd">synchronized</span> <span class="o">(</span><span class="nc">MyClass</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="n">value</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="4-자바-concurrency-유틸리티">4. 자바 Concurrency 유틸리티</h2>
<blockquote>
  <p>자바 Concurrent 패키지 관련은 <a href="../java/concurrent_package">Concurrent 패키지</a> 포스팅을 참고할 것.</p>
</blockquote>

<p>synchronized 키워드는 여러 쓰레드에 공유되는 객체에 대한 동기화 매커니즘이다. 이 방식은 아주 훌륭한 방식은 아니었고 이후 보다 나은 동시성 컨트롤을 위해 Concurrency API가 나왔다. (Java 5)</p>

<p>synchronized가 암시적인 lock이라면 concurrent package에 있는 ReentrantLock은 명시적인 lock 객체이다.</p>

<hr />

<blockquote>
  <p><strong>[참고 문서]</strong> <br /></p>
  <ul>
    <li><a href="http://egloos.zum.com/iilii/v/4071694">참고 블로그1</a> <br /></li>
    <li><a href="http://noesse.tistory.com/27">참고 블로그2</a> <br /></li>
  </ul>
</blockquote>

<!-- 참조하는 링크
   - java/thread : 2016-01-01-Thread
   - java/concurrent_package : 2016-01-01-Concurrent 패키지 -->

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#java" class="page__taxonomy-item" rel="tag">Java</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2016-01-01T00:00:00+09:00">January 1, 2016</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=synchronized%20http%3A%2F%2Flocalhost%3A4000%2Fjava%2Fjava_synchronized" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fjava%2Fjava_synchronized" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fjava%2Fjava_synchronized" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/java/thread" class="pagination--pager" title="자바의 Thread
">이전</a>
    
    
      <a href="/java/volatile-%ED%82%A4%EC%9B%8C%EB%93%9C/" class="pagination--pager" title="volatile 키워드
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">참고</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B8%94%EB%A1%9C%EA%B9%85/3.-GitHub-pages-%EA%B5%AC%EC%B6%95-%ED%9B%84-%EC%84%A4%EC%A0%95/" rel="permalink">GitHub pages 구축 후 설정 (3)
</a>
      
    </h2>
    


  <p class="page__meta">

    
      
      <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
      <time datetime="2020-09-17T00:00:00+09:00">September 17, 2020</time>
    

    
      
        <br \>
      
    

    
      
      

      <i class="far fa-fw fa-clock" aria-hidden="true"></i>
      
        1 분 소요
      
    

  </p>

    <p class="archive__item-excerpt" itemprop="description">블로그 구성을 위해 했던 History 관리차 기록합니다.

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B8%94%EB%A1%9C%EA%B9%85/2.-GitHub-pages-%EB%A1%9C-%EB%B8%94%EB%A1%9C%EA%B7%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0/" rel="permalink">GitHub pages로 블로그 만들기 (2)
</a>
      
    </h2>
    


  <p class="page__meta">

    
      
      <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
      <time datetime="2020-09-16T00:00:00+09:00">September 16, 2020</time>
    

    
      
        <br \>
      
    

    
      
      

      <i class="far fa-fw fa-clock" aria-hidden="true"></i>
      
        5 분 소요
      
    

  </p>

    <p class="archive__item-excerpt" itemprop="description">1. 저장소(Repository) 생성 및 설정
Git repository를 이용하는 것인만큼 Git에 새로운 Repository를 만들어야 한다. 
 주의할 점은 이 때 Repository 이름에 따라서 블로그의 도메인 주소가 바뀐다. 
 https://id.github.io 형...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B8%94%EB%A1%9C%EA%B9%85/1.-GitHub-pages-%EC%99%80-%ED%85%8C%EB%A7%88/" rel="permalink">GitHub pages와 테마에 대해서 (1)
</a>
      
    </h2>
    


  <p class="page__meta">

    
      
      <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
      <time datetime="2020-09-15T00:00:00+09:00">September 15, 2020</time>
    

    
      
        <br \>
      
    

    
      
      

      <i class="far fa-fw fa-clock" aria-hidden="true"></i>
      
        3 분 소요
      
    

  </p>

    <p class="archive__item-excerpt" itemprop="description">GitHub에서 제공하는 GitHub Pages 기능을 이용하면 간단한 사이트를 만들 수 있다. 
 이렇게 만들어진 사이트는 https://{my-github-id}.github.io 형태의 사이트가 된다.

  Github pages 공식 자료


여기서는 Jekyll 을 이용한...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/security/encryption_algorithm" rel="permalink">암호화 알고리즘의 분류
</a>
      
    </h2>
    


  <p class="page__meta">

    
      
      <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
      <time datetime="2016-01-01T00:00:00+09:00">January 1, 2016</time>
    

    
      
        <br \>
      
    

    
      
      

      <i class="far fa-fw fa-clock" aria-hidden="true"></i>
      
        3 분 소요
      
    

  </p>

    <p class="archive__item-excerpt" itemprop="description">0. Intro
암호화 알고리즘은 크게 대칭형와 비대칭형 2가지로 나뉘는데 이는 암호화에 사용하는 Key와 복호화에 사용하는 Key가 같은지 다른지를 기준으로 분류된다. 
 통상적으로 대칭형 암호는 비밀키 암호에 사용되며 비대칭형 암호는 공개키 암호에 사용된다. 따라서 각각  대칭...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="검색어를 입력하세요..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 안드로이드 개발 및 기타. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5&appId=1759901007629019";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
  





  </body>
</html>
